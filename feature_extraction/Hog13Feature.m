function out = Hog13Feature(img)
    hog36 = hog(img, 4, 9);
    %[h, w, d] = size(hog36);
%     out = zeros(h, w, 13, 'single');
%     for b=1:9
%         out(:,:,b)=sum(hog36(:,:,b:9:b+27),3);
%     end
%     for n=1:4
%         out(:,:,9+n)=sum(hog36(:,:,(n-1)*9+1:n*9),3);
%     end
    %m = zeros(36,13);
%    for n=1:9
%        m(n:9:n+27,n)=[1 1 1 1]';
%    end
%    for n=1:4
%        m((n-1)*9+1:n*9,9+n)=[1 1 1 1 1 1 1 1 1]';
%    end
%   m=[1     0     0     0     0     0     0     0     0     1     0     0     0;
%      0     1     0     0     0     0     0     0     0     1     0     0     0;
%      0     0     1     0     0     0     0     0     0     1     0     0     0;
%      0     0     0     1     0     0     0     0     0     1     0     0     0;
%      0     0     0     0     1     0     0     0     0     1     0     0     0;
%      0     0     0     0     0     1     0     0     0     1     0     0     0;
%      0     0     0     0     0     0     1     0     0     1     0     0     0;
%      0     0     0     0     0     0     0     1     0     1     0     0     0;
%      0     0     0     0     0     0     0     0     1     1     0     0     0;
%      1     0     0     0     0     0     0     0     0     0     1     0     0;
%      0     1     0     0     0     0     0     0     0     0     1     0     0;
%      0     0     1     0     0     0     0     0     0     0     1     0     0;
%      0     0     0     1     0     0     0     0     0     0     1     0     0;
%      0     0     0     0     1     0     0     0     0     0     1     0     0;
%      0     0     0     0     0     1     0     0     0     0     1     0     0;
%      0     0     0     0     0     0     1     0     0     0     1     0     0;
%      0     0     0     0     0     0     0     1     0     0     1     0     0;
%      0     0     0     0     0     0     0     0     1     0     1     0     0;
%      1     0     0     0     0     0     0     0     0     0     0     1     0;
%      0     1     0     0     0     0     0     0     0     0     0     1     0;
%      0     0     1     0     0     0     0     0     0     0     0     1     0;
%      0     0     0     1     0     0     0     0     0     0     0     1     0;
%      0     0     0     0     1     0     0     0     0     0     0     1     0;
%      0     0     0     0     0     1     0     0     0     0     0     1     0;
%      0     0     0     0     0     0     1     0     0     0     0     1     0;
%      0     0     0     0     0     0     0     1     0     0     0     1     0;
%      0     0     0     0     0     0     0     0     1     0     0     1     0;
%      1     0     0     0     0     0     0     0     0     0     0     0     1;
%      0     1     0     0     0     0     0     0     0     0     0     0     1;
%      0     0     1     0     0     0     0     0     0     0     0     0     1;
%      0     0     0     1     0     0     0     0     0     0     0     0     1;
%      0     0     0     0     1     0     0     0     0     0     0     0     1;
%      0     0     0     0     0     1     0     0     0     0     0     0     1;
%      0     0     0     0     0     0     1     0     0     0     0     0     1;
%      0     0     0     0     0     0     0     1     0     0     0     0     1;
%      0     0     0     0     0     0     0     0     1     0     0     0     1];
%     out=reshape(reshape(hog36,h*w,d)*m,h,w,13);
    out=hog13Mex(hog36);
end